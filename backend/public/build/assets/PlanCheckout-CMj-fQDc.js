import{_ as ee,c as i,a as e,F as T,A as D,C as L,o as r,u as re,E as ce,I as de,r as k,m as H,h as ue,i as pe,p as me,S as m,G as F,s as z,b as X,t as l,M as he,d as C,e as _,H as ve,x as R,y as _e,z as U,n as Z,N as fe}from"./app-BOhBFs9K.js";/* empty css            */const ye={},ge={class:"container py-5"},we={class:"row g-4"},be={class:"col-lg-6"},ke={class:"card shadow-sm rounded-4 p-4"},xe={class:"col-lg-6"},$e={class:"card shadow-sm rounded-4 p-4"},Ce={class:"list-group mb-3"};function Pe(te,c){return r(),i("div",ge,[e("div",we,[e("div",be,[e("div",ke,[c[1]||(c[1]=e("div",{class:"placeholder-glow mb-4"},[e("span",{class:"placeholder col-6",style:{height:"18px"}})],-1)),c[2]||(c[2]=e("div",{class:"placeholder-glow mb-3"},[e("span",{class:"placeholder col-12",style:{height:"10px"}})],-1)),(r(),i(T,null,D(3,n=>e("div",{key:n,class:"card mb-3 shadow-sm border-0 rounded-4"},c[0]||(c[0]=[L('<div class="row g-0"><div class="col-md-4"><div class="placeholder-glow w-100 h-100" style="height:120px;background-color:#e0e0e0;"></div></div><div class="col-md-8 p-3"><h5 class="placeholder-glow"><span class="placeholder col-6"></span></h5><p class="placeholder-glow mb-2"><span class="placeholder col-4"></span></p><p class="placeholder-glow"><span class="placeholder col-2"></span></p></div></div>',1)]))),64))])]),e("div",xe,[e("div",$e,[c[5]||(c[5]=e("div",{class:"placeholder-glow mb-4"},[e("span",{class:"placeholder col-6",style:{height:"18px"}})],-1)),e("ul",Ce,[(r(),i(T,null,D(2,n=>e("li",{key:"right-course-"+n,class:"list-group-item d-flex justify-content-between align-items-center placeholder-glow"},c[3]||(c[3]=[e("span",{class:"placeholder col-5"},null,-1),e("span",{class:"placeholder col-2"},null,-1)]))),64)),c[4]||(c[4]=e("li",{class:"list-group-item d-flex justify-content-between align-items-center placeholder-glow"},[e("span",{class:"placeholder col-4"}),e("span",{class:"placeholder col-2"})],-1))]),c[6]||(c[6]=L('<div class="placeholder-glow mb-3"><span class="placeholder col-12" style="height:38px;"></span></div><div class="row"><div class="col-md-6 mb-3"><div class="placeholder-glow"><span class="placeholder col-12" style="height:38px;"></span></div></div><div class="col-md-6 mb-3"><div class="placeholder-glow"><span class="placeholder col-12" style="height:38px;"></span></div></div></div><div class="placeholder-glow"><span class="placeholder col-12" style="height:44px;"></span></div>',3))])])])])}const Te=ee(ye,[["render",Pe]]),De={key:0,class:"text-center py-5"},Be={key:0,class:"fullpage-skeleton bg-white"},Ie={key:1,class:"container py-3"},Se={class:"row g-4 d-flex align-items-stretch"},je={class:"col-lg-6"},Oe={class:"card shadow-sm rounded-4"},Me={class:"card-body"},qe={class:"mb-4 text-primary"},Ne={disabled:"",value:""},We=["value","selected"],Fe={class:"mb-3"},Ve={key:0,class:"course-scroll-container"},ze={class:"row g-0 align-items-center"},Ae=["onClick"],Ee=["src"],He=["onClick"],Re={class:"card-body"},Ue={class:"d-flex justify-content-between"},Le={class:"card-title mb-1"},Ge=["onClick"],Ye=["id","value","disabled"],Je={class:"card-text text-muted mb-1"},Ke={class:"card-text fw-bold text-primary mb-0"},Qe={key:0,class:"course-skeletons"},Xe={key:1,class:"alert alert-danger mt-3"},Ze={class:"col-lg-6"},et={class:"card shadow-sm rounded-4 mb-3"},tt={class:"card-body"},st={class:"mb-4 text-primary"},lt={key:0,class:"list-group mb-3 shadow-sm"},ot=["src"],at={class:"text-muted"},nt={class:"list-group-item d-flex justify-content-between"},it={class:"text-primary"},rt={class:"list-group-item d-flex justify-content-between"},ct={class:"text-primary"},dt={key:0,class:"list-group-item d-flex justify-content-center"},ut={class:"text-center text-muted"},pt={class:"text-primary"},mt={class:"text-primary"},ht={key:1,class:"text-muted list-group mb-3"},vt={class:"list-group-item d-flex justify-content-between align-items-center"},_t={class:"card shadow-sm rounded-4"},ft={class:"card-body"},yt={class:"d-flex flex-column"},gt={class:"mb-3"},wt={class:"d-flex justify-content-between align-items-center mb-4"},bt={class:"fw-bold"},kt={class:"bg-lightgreen text-success rounded px-2 py-1 text-center"},xt={class:"payment-method-container"},$t=["onClick"],Ct=["src"],Pt=["checked"],Tt={class:"border-top p-4 d-flex align-items-start gap-3"},Dt={class:"form-check-label",for:"exampleCheck1"},Bt={class:"mt-auto border-top p-4"},It={__name:"PlanCheckout",setup(te){const c=de(),n=re(),se=ce();c.query.id;const g=k("paypal");let j=k(!1);const B=k([]),O=k({}),h=k(""),u=k([]),M=k(""),I=k(!0),w=k(0),V=H(()=>u.value.reduce((t,s)=>t+s.price,0).toFixed(2)),G=H(()=>{var t;return(t=h.value)!=null&&t.price?(V.value-h.value.price).toFixed(2):0}),le=H(()=>V.value?Math.round(G.value/V.value*100):0),oe=()=>{if(!h.value){M.value="Please select a plan first.";return}j.value&&g.value&&h.value&&u.value.length>0?(console.log(`Selected Plan: ${h.value.title}, Payment Method: ${g.value}`),ne()):u.value.length===0?m.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:s=>{s.onmouseenter=m.stopTimer,s.onmouseleave=m.resumeTimer}}).fire({icon:"error",title:"Oops...",text:"Please select a course to proceed with payment."}):j.value||m.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:s=>{s.onmouseenter=m.stopTimer,s.onmouseleave=m.resumeTimer}}).fire({icon:"error",title:"Oops...",text:"Please select a payment method and agree to the terms and conditions"})},ae=async()=>{try{I.value=!0;const t=await U.get("/plan/list");O.value=t.data.data;const s=O.value.find(a=>a.id==c.query.id);s?(h.value=s,await A(s.id)):(h.value=O.value[0],await A(O.value[0].id))}catch(t){console.error(t),M.value="Failed to load course data."}finally{I.value=!1}};ue(h,t=>{t&&t.id&&(u.value=[],A(t.id))});const A=async(t=null)=>{try{I.value=!0;const s=await U.get(`/plan/show/${t}`);B.value=s.data.data.courses||[],w.value=parseInt(s.data.data.course_limit)||0}catch(s){console.error(s),M.value="Failed to load course data."}finally{I.value=!1}},ne=async()=>{var t,s,a,p,v,P;if(g.value=="stripe"||g.value=="paypal"||g.value=="razorpay"){if(((t=n==null?void 0:n.masterData)==null?void 0:t.currency)!="USD"&&h.value.price<((s=n==null?void 0:n.masterData)==null?void 0:s.minimum_amount)){m.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:d=>{d.onmouseenter=m.stopTimer,d.onmouseleave=m.resumeTimer}}).fire({icon:"error",title:"Oops...",text:`Please note that a minimum of grand total of ${(a=n==null?void 0:n.masterData)==null?void 0:a.minimum_amount} is required for transaction.`});return}if(((p=n==null?void 0:n.masterData)==null?void 0:p.currency)=="BDT"){m.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1500,timerProgressBar:!0,didOpen:d=>{d.onmouseenter=m.stopTimer,d.onmouseleave=m.resumeTimer}}).fire({icon:"error",title:"Oops...",text:"BDT is not supported at the moment"});return}}try{const y=await U.get("/plan-enroll",{headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${se.authToken}`},params:{payment_gateway:g.value,total_amount:h.value.price,plan_id:h.value.id,course_ids:u.value?u.value.map(d=>d.id):[]}});ie(y.data.data.payment_webview_url)}catch(y){m.fire({icon:"error",title:"Oops...",text:((P=(v=y.response)==null?void 0:v.data)==null?void 0:P.message)||"Something went wrong. Please try again."})}},ie=(t,s=!1)=>{s&&console.log(`Opening payment window: ${t}`);const a=700,p=700,v=screen.width/2-a/2,P=screen.height/2-p/2,y=`resizable,height=${p},width=${a},top=${P},left=${v}`,d=window.open(t,"_blank",y);if(!d){s&&console.error("Failed to open payment window");return}d.document.title="Payment Window Screen - Make Payment";let b=null;const x=$=>{s&&console.log(`Closing with status: ${$}`),d&&!d.closed&&d.close(),window.location.pathname!=="/plan_enroll_status"&&(window.location.href=`/plan_enroll_status?status=${$}`)};b=setInterval(()=>{try{if(d.closed){s&&console.log("Window manually closed"),clearInterval(b),x("closed");return}const $=location.host;if(d.location.host===$){const S=d.location.pathname;S.includes("payment/success")?(clearInterval(b),x("success")):S.includes("payment/cancel")?(clearInterval(b),x("cancel")):(S.includes("payment/fail"),clearInterval(b),x("fail"))}}catch{s&&console.warn("Cross-origin access blocked; cannot track status until redirect returns to same-origin.")}},10),d.focus()},q=t=>{const s=document.getElementById(`course-${t.id}`);if(!s)return;const a=s.checked=!s.checked,p=u.value.some(v=>v.id===t.id);a&&!p?u.value.push(t):!a&&p&&(u.value=u.value.filter(v=>v.id!==t.id))};return pe(async()=>{await ae(),await me();const t=c.query.course_id;if(t){const a=B.value.find(p=>p.id==t);a&&q(a)}const s=c.query.course_ids?c.query.course_ids.split(",").map(a=>parseInt(a.trim())).filter(a=>!isNaN(a)):[];if(s.length>0){const a=B.value.filter(p=>s.includes(p.id));a.length>w.value?m.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:v=>{v.onmouseenter=m.stopTimer,v.onmouseleave=m.resumeTimer}}).fire({icon:"error",title:"Oops...",text:`Cannot select ${a.length} courses. The plan allows a maximum of ${w.value} courses.`}):a.forEach(p=>{q(p)})}}),(t,s)=>{var p,v,P,y,d,b,x,E,$,S,Y,J,K,Q;const a=_e("router-link");return I.value?(r(),i("div",De,[I.value?(r(),i("div",Be,[z(Te)])):F("",!0)])):(r(),i("div",Ie,[e("div",Se,[e("div",je,[e("div",Oe,[e("div",Me,[e("h4",qe,l(t.$t("Select Subscription Plan")),1),X(e("select",{class:"form-select mb-4","onUpdate:modelValue":s[0]||(s[0]=o=>h.value=o)},[e("option",Ne,l(t.$t("Choose Plan")),1),(r(!0),i(T,null,D(O.value,o=>(r(),i("option",{key:o.id,value:o,selected:o.id==t.$route.query.id},l(o.title)+" ("+l(t.$t("Max"))+" "+l(o.course_limit)+" "+l(t.$t("courses"))+") ",9,We))),128))],512),[[he,h.value]]),e("h4",Fe,l(t.$t("Select Courses")),1),w.value!==null&&B.value.length>0?(r(),i("div",Ve,[(r(!0),i(T,null,D(B.value,o=>{var N,W;return r(),i("div",{key:o.id,class:Z(["card mb-3 shadow-sm border-0 rounded-4",w.value!==null&&u.value.length>=w.value&&!u.value.some(f=>f.id===o.id)?"disabled-course":""])},[e("div",ze,[e("div",{class:"col-md-4",onClick:f=>q(o)},[e("img",{src:o.thumbnail,class:"img-fluid rounded-start w-100 h-100 object-fit-cover",alt:"Course Thumbnail"},null,8,Ee)],8,Ae),e("div",{class:"col-md-8",onClick:f=>q(o)},[e("div",Re,[e("div",Ue,[e("h5",Le,l(o.title),1),e("div",{class:"form-check ms-2",onClick:f=>q(o)},[X(e("input",{class:"form-check-input",type:"checkbox",id:"course-"+o.id,value:o,disabled:w.value!==null&&u.value.length>=w.value&&!u.value.some(f=>f.id===o.id),"onUpdate:modelValue":s[1]||(s[1]=f=>u.value=f),style:{width:"20px",height:"20px"}},null,8,Ye),[[fe,u.value]])],8,Ge)]),e("p",Je,l(o.instructor.user.name),1),e("p",Ke,l((W=(N=C(n))==null?void 0:N.masterData)==null?void 0:W.currency_symbol)+l(o.price?o.price:o.regular_price),1)])],8,He)])],2)}),128)),B.value.length===0?(r(),i("div",Qe,[(r(),i(T,null,D(3,o=>e("div",{key:o,class:"card mb-3 shadow-sm border-0 rounded-4"},s[3]||(s[3]=[L('<div class="row g-0" data-v-299010d1><div class="col-md-4" data-v-299010d1><div class="placeholder-glow w-100 h-100" style="height:120px;background-color:#e0e0e0;" data-v-299010d1></div></div><div class="col-md-8 p-3" data-v-299010d1><h5 class="placeholder-glow" data-v-299010d1><span class="placeholder col-6" data-v-299010d1></span></h5><p class="placeholder-glow mb-2" data-v-299010d1><span class="placeholder col-4" data-v-299010d1></span></p><p class="placeholder-glow" data-v-299010d1><span class="placeholder col-2" data-v-299010d1></span></p></div></div>',1)]))),64))])):F("",!0)])):F("",!0),M.value?(r(),i("div",Xe,l(M.value),1)):F("",!0)])])]),e("div",Ze,[e("div",et,[e("div",tt,[e("h4",st,l(t.$t("Payment Details")),1),e("div",null,[u.value.length>0?(r(),i("ul",lt,[(r(!0),i(T,null,D(u.value,(o,N)=>{var W,f;return r(),i("li",{key:o.id,class:"list-group-item d-flex justify-content-between align-items-center"},[e("span",null,[_(" #"+l(N+1)+" ",1),e("img",{src:o.thumbnail,class:"me-1 ms-1 course-thumbnail",alt:"..."},null,8,ot),_(" "+l(o.title.slice(0,40)+(o.title.length>40?"...":"")),1)]),e("strong",at,l((f=(W=C(n))==null?void 0:W.masterData)==null?void 0:f.currency_symbol)+l(o.price?o.price:o.regular_price),1)])}),128)),e("li",nt,[e("strong",null,l(t.$t("Total Price Without Plan")),1),e("strong",it,l((v=(p=C(n))==null?void 0:p.masterData)==null?void 0:v.currency_symbol)+l(V.value),1)]),e("li",rt,[e("strong",null,l(t.$t("Subscription Plan Price")),1),e("strong",ct,l((y=(P=C(n))==null?void 0:P.masterData)==null?void 0:y.currency_symbol)+l((d=h.value)==null?void 0:d.price),1)]),u.value.length>=w.value?(r(),i("li",dt,[e("strong",ut,[_(l(t.$t("You save"))+" ",1),e("span",pt,l(((x=(b=C(n))==null?void 0:b.masterData)==null?void 0:x.currency_symbol)+G.value),1),_(" – "+l(t.$t("that’s mean"))+" ",1),e("span",mt,l(le.value)+"%",1),_(" "+l(t.$t("off"))+"! ",1)])])):F("",!0)])):(r(),i("ul",ht,[e("li",vt,l(t.$t("Please select at least one course to proceed with payment"))+".",1)]))])])]),e("div",_t,[e("div",ft,[e("div",yt,[e("div",gt,[e("div",wt,[e("h5",bt,l(t.$t("Payment Method")),1),e("small",kt,[s[4]||(s[4]=e("i",{class:"ri-shield-check-fill me-1"},null,-1)),_(" "+l(t.$t("100% Secure Payment")),1)])]),e("div",xt,[(r(!0),i(T,null,D(($=(E=C(n))==null?void 0:E.masterData)==null?void 0:$.payment_methods,o=>(r(),i("div",{key:o.id},[e("div",{onClick:N=>g.value=o.gateway,class:Z("border d-flex justify-content-between align-items-center px-3 mb-3 rounded payment-method"+(g.value==o.gateway?" selected":""))},[e("img",{src:o.logo,class:"py-3 payment-logo"},null,8,Ct),e("input",{class:"form-check-input",type:"radio",checked:g.value==o.gateway},null,8,Pt)],10,$t)]))),128))])]),e("div",Tt,[e("input",{type:"checkbox",class:"form-check-input",id:"exampleCheck1",required:"",onChange:s[2]||(s[2]=o=>ve(j)?j.value=!0:j=!0)},null,32),e("label",Dt,[_(l(t.$t("By proceeding, you agree to the"))+" ",1),z(a,{to:"/page/terms_and_conditions",class:"text-decoration-none bg-transparent border-0 text-primary"},{default:R(()=>[_(l(t.$t("Terms & Condition")),1)]),_:1}),s[5]||(s[5]=_(",",-1)),z(a,{to:"/page/privacy_policy",class:"text-decoration-none bg-transparent border-0 text-primary"},{default:R(()=>[_(l(t.$t("Privacy Policy")),1)]),_:1}),_(" "+l(t.$t("and"))+" ",1),z(a,{to:"/page/refund_policy",class:"text-decoration-none bg-transparent border-0 text-primary"},{default:R(()=>[_(l(t.$t("Refund Policy")),1)]),_:1}),_(" of "+l((Y=(S=C(n))==null?void 0:S.masterData)==null?void 0:Y.name),1)])]),e("div",Bt,[e("button",{onClick:oe,class:"btn btn-primary rounded-pill fw-bold w-100"},[_(l(t.$t("Pay"))+" "+l((K=(J=C(n))==null?void 0:J.masterData)==null?void 0:K.currency_symbol)+l((Q=h.value)==null?void 0:Q.price)+" ",1),s[6]||(s[6]=e("i",{class:"bi bi-arrow-right float-end"},null,-1))])])])])])])])]))}}},Ot=ee(It,[["__scopeId","data-v-299010d1"]]);export{Ot as default};
